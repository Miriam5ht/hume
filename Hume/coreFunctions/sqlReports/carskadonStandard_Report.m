function [reportName, statistics] = exportReport(recordList)

      reportName = 'Standard Table';
      if nargin > 0
          
      setdbprefs('DataReturnFormat','Table');  
      statistics =  fetch(getappdata(0,'Conn'), ['SELECT ', ...
            'SleepLabStats.idStudy.id, ', ...
            'SleepLabStats.idStudy.study, ', ...
            'SleepLabStats.EDFInfo.EDFname, ', ...
            'SleepLabStats.EDFInfo.condition, ', ...
            'SleepLabStats.scoredInfo.scorer, ', ...
            'SleepLabStats.scoredInfo.record, ', ...
            'SleepLabStats.TDT.Minutes AS TDTmin, ', ...
            'SleepLabStats.SPT.Minutes AS SPTmin, ', ...
            'SleepLabStats.SPT.TDTper AS [SPT_TDTper], ', ...
            'SleepLabStats.TST.Minutes AS TSTmin, ', ...
            'SleepLabStats.TST.TDTper AS [TST_TDTper], ', ...
            'SleepLabStats.TST.SPTper AS [TST_SPTper], ', ...
            'SleepLabStats.WAFA.Minutes AS WAFAmin, ', ...
            'SleepLabStats.WASO.Minutes AS WASOmin, ', ...
            'SleepLabStats.latencySleep.Minutes AS SleepLatency, ', ...
            'SleepLabStats.latencySOREM.Minutes AS REML, ', ...
            'SleepLabStats.TWT.Minutes AS TWTmin, ', ...
            'SleepLabStats.TWT.TSTper AS [TWT_TSTper], ', ...
            'SleepLabStats.Stage1.Minutes AS [St1_min], ', ...
            'SleepLabStats.Stage1.TSTper AS [St1_TSTper], ', ...
            'SleepLabStats.Stage2.Minutes AS [St2_min], ', ...
            'SleepLabStats.Stage2.TSTper AS [St2_TSTper], ', ...
            'SleepLabStats.Stage3.Minutes AS [St3_min], ', ...
            'SleepLabStats.Stage3.TSTper AS [St3_TSTper], ', ...
            'SleepLabStats.Stage4.Minutes AS [St4_min], ', ...
            'SleepLabStats.Stage4.TSTper AS [St4_TSTper], ', ...
            'SleepLabStats.REM.Minutes AS [REM_min], ', ...
            'SleepLabStats.REM.TSTper AS [REM_TSTper], ', ...
            'SleepLabStats.MT.Minutes AS [MT_min], ', ...
            'SleepLabStats.MT.TSTper AS [MT_TSTper], ', ...
            'SleepLabStats.SW.Minutes AS [SW_min], ', ...
            'SleepLabStats.SW.TSTper AS [SW_TSTper], ', ...
            'SleepLabStats.NREM.Minutes AS [NREM_min], ', ...
            'SleepLabStats.NREM.TSTper AS [NREM_TSTper] ', ...
            'FROM ', ...
            'SleepLabStats.EDFInfo ', ...
            'JOIN SleepLabStats.idStudy ', ...
            'ON SleepLabStats.EDFInfo.id = SleepLabStats.idStudy.id  ', ...
            'JOIN SleepLabStats.scoredInfo ', ...
            'ON SleepLabStats.scoredInfo.EDFname = SleepLabStats.EDFInfo.EDFname  ', ...
            'JOIN SleepLabStats.TST ', ...
            'ON SleepLabStats.TST.record = SleepLabStats.scoredInfo.record  ', ...
            'JOIN SleepLabStats.SPT ', ...
            'ON SleepLabStats.SPT.record = SleepLabStats.scoredInfo.record  ', ...
            'JOIN SleepLabStats.TDT ', ...
            'ON SleepLabStats.TDT.record = SleepLabStats.scoredInfo.record  ', ...
            'JOIN SleepLabStats.WAFA ', ...
            'ON SleepLabStats.WAFA.record = SleepLabStats.scoredInfo.record  ', ...
            'JOIN SleepLabStats.WASO ', ...
            'ON SleepLabStats.WASO.record = SleepLabStats.scoredInfo.record  ', ...
            'JOIN SleepLabStats.latencySleep ', ...
            'ON SleepLabStats.latencySleep.record = SleepLabStats.scoredInfo.record  ', ...
            'JOIN SleepLabStats.latencySOREM ', ...
            'ON SleepLabStats.latencySOREM.record = SleepLabStats.scoredInfo.record  ', ...
            'JOIN SleepLabStats.TWT ', ...
            'ON SleepLabStats.TWT.record = SleepLabStats.scoredInfo.record  ', ...
            'JOIN SleepLabStats.Stage1 ', ...
            'ON SleepLabStats.Stage1.record = SleepLabStats.scoredInfo.record  ', ...
            'JOIN SleepLabStats.Stage2 ', ...
            'ON SleepLabStats.Stage2.record = SleepLabStats.scoredInfo.record  ', ...
            'JOIN SleepLabStats.Stage3 ', ...
            'ON SleepLabStats.Stage3.record = SleepLabStats.scoredInfo.record  ', ...
            'JOIN SleepLabStats.Stage4 ', ...
            'ON SleepLabStats.Stage4.record = SleepLabStats.scoredInfo.record  ', ...
            'JOIN SleepLabStats.REM ', ...
            'ON SleepLabStats.REM.record = SleepLabStats.scoredInfo.record  ', ...
            'JOIN SleepLabStats.MT ', ...
            'ON SleepLabStats.MT.record = SleepLabStats.scoredInfo.record  ', ...
            'JOIN SleepLabStats.SW ', ...
            'ON SleepLabStats.SW.record = SleepLabStats.scoredInfo.record  ', ...
            'JOIN SleepLabStats.NREM ', ...
            'ON SleepLabStats.NREM.record = SleepLabStats.scoredInfo.record ', ...
            'WHERE SleepLabStats.scoredInfo.record IN (',strjoin(strcat('''',recordList,''''),', '),');']);
            setdbprefs('DataReturnFormat','cellarray');  
      end
end
